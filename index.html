<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fastline多情景财务预测计算器</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1a4f72;
            --secondary: #3a7ca5;
            --accent: #f39c12;
            --success: #27ae60;
            --warning: #e67e22;
            --danger: #e74c3c;
            --light: #f8f9fa;
            --dark: #2c3e50;
            --border: #dee2e6;
            --shadow: rgba(0,0,0,0.1);
            --conservative: #e74c3c;
            --neutral: #3498db;
            --optimistic: #2ecc71;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Noto Sans SC', 'Segoe UI', 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf9 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.92;
            position: relative;
            z-index: 1;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .tab.active {
            background: var(--primary);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 1200px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            padding: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            height: auto;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }
        
        .card h2 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
            font-size: 1.7rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card h3 {
            color: var(--secondary);
            margin: 20px 0 15px;
            font-size: 1.3rem;
            position: relative;
            padding-left: 15px;
        }
        
        .card h3::before {
            content: '';
            position: absolute;
            left: 0;
            top: 7px;
            width: 6px;
            height: 22px;
            background: var(--secondary);
            border-radius: 3px;
        }
        
        input, select {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid #cbd5e0;
            border-radius: 8px;
            font-size: 1rem;
            background: #fff;
            transition: all 0.2s ease;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 4px rgba(58, 124, 165, 0.2);
        }
        
        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            min-width: 160px;
        }
        
        button i {
            font-size: 1.1rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #2c6c96, #153a57);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--accent), #e67e22);
            color: white;
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, #e67e22, #d35400);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success), #2ecc71);
            color: white;
        }
        
        .btn-success:hover {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .chart-container {
            margin-top: 25px;
            height: 280px;
            position: relative;
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .summary-card {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        
        .summary-item {
            background: white;
            border-radius: 10px;
            padding: 16px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.06);
            border: 1px solid rgba(0,0,0,0.03);
            transition: transform 0.3s ease;
        }
        
        .summary-item:hover {
            transform: translateY(-3px);
        }
        
        .summary-value {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 10px 0;
            letter-spacing: -0.5px;
        }
        
        .summary-label {
            font-size: 0.95rem;
            color: #4a5568;
            font-weight: 500;
        }
        
        .profit {
            color: var(--success);
        }
        
        .loss {
            color: var(--danger);
        }
        
        .input-label {
            font-weight: bold;
            margin-bottom: 6px;
            display: block;
            color: var(--dark);
            font-size: 0.95rem;
        }
        
        .input-with-unit {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .input-with-unit input {
            flex: 1;
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
            font-size: 1.1rem;
        }
        
        .input-unit {
            background: #e9ecef;
            padding: 0 12px;
            height: 100%;
            display: flex;
            align-items: center;
            border: 1px solid #ced4da;
            border-left: none;
            border-top-right-radius: 8px;
            border-bottom-right-radius: 8px;
            min-width: 80px;
            font-size: 0.85rem;
        }
        
        .param-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .param-item {
            display: flex;
            flex-direction: column;
            margin-bottom: 12px;
        }
        
        .scenario-section {
            border-left: 4px solid var(--neutral);
            padding: 15px;
            border-radius: 8px;
            background: rgba(52, 152, 219, 0.05);
            margin-bottom: 20px;
        }
        
        .scenario-conservative {
            border-left-color: var(--conservative);
            background: rgba(231, 76, 60, 0.05);
        }
        
        .scenario-optimistic {
            border-left-color: var(--optimistic);
            background: rgba(46, 204, 113, 0.05);
        }
        
        .financial-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .financial-table th {
            background: var(--primary);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        
        .financial-table td {
            padding: 12px;
            border-bottom: 1px solid var(--border);
        }
        
        .financial-table tr:last-child td {
            border-bottom: none;
        }
        
        .financial-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .value-positive {
            color: var(--success);
            font-weight: 600;
        }
        
        .value-negative {
            color: var(--danger);
            font-weight: 600;
        }
        
        .scenario-tabs {
            display: flex;
            margin-bottom: 20px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .scenario-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .scenario-tab.conservative {
            background: rgba(231, 76, 60, 0.1);
            color: var(--conservative);
        }
        
        .scenario-tab.neutral {
            background: rgba(52, 152, 219, 0.1);
            color: var(--neutral);
        }
        
        .scenario-tab.optimistic {
            background: rgba(46, 204, 113, 0.1);
            color: var(--optimistic);
        }
        
        .scenario-tab.active {
            background: var(--primary);
            color: white;
        }
        
        .calculation-formula {
            font-size: 0.8rem;
            color: #666;
            font-style: italic;
            margin-top: 4px;
        }
        
        footer {
            text-align: center;
            margin-top: 35px;
            padding: 20px;
            color: #718096;
            font-size: 0.85rem;
        }
        
        @media (max-width: 600px) {
            h1 {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn-group button {
                width: 100%;
                margin-bottom: 10px;
            }
            
            .param-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-chart-line"></i> Fastline多情景财务预测计算器</h1>
            <p class="subtitle">保守、中性、乐观三种情景下的财务预测分析 | 动态计算与可视化</p>
        </header>
        
        <div class="tabs">
            <div class="tab active" data-tab="parameters">参数设置</div>
            <div class="tab" data-tab="results">预测结果</div>
            <div class="tab" data-tab="analysis">投资分析</div>
        </div>
        
        <!-- 参数设置 -->
        <div class="tab-content active" id="parameters-tab">
            <div class="dashboard">
                <div class="card">
                    <h2><i class="fas fa-sliders-h"></i> 基础参数设置</h2>
                    
                    <div class="scenario-section">
                        <h3><i class="fas fa-cube"></i> 仓储参数</h3>
                        
                        <div class="param-grid">
                            <div class="param-item">
                                <label for="storage-price">每托盘月存储费 (USD)</label>
                                <div class="input-with-unit">
                                    <input type="number" id="storage-price" value="20" step="0.5">
                                    <div class="input-unit">USD</div>
                                </div>
                            </div>
                            
                            <div class="param-item">
                                <label for="usd-cad-rate">USD/CAD汇率</label>
                                <div class="input-with-unit">
                                    <input type="number" id="usd-cad-rate" value="1.35" step="0.01">
                                    <div class="input-unit">汇率</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="scenario-section">
                        <h3><i class="fas fa-money-bill-alt"></i> 成本参数</h3>
                        
                        <div class="param-grid">
                            <div class="param-item">
                                <label for="fixed-cost">月固定成本</label>
                                <div class="input-with-unit">
                                    <input type="number" id="fixed-cost" value="60833" step="1000">
                                    <div class="input-unit">CAD</div>
                                </div>
                            </div>
                            
                            <div class="param-item">
                                <label for="investment-amount">投资总额</label>
                                <div class="input-with-unit">
                                    <input type="number" id="investment-amount" value="600000" step="10000">
                                    <div class="input-unit">CAD</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="scenario-section">
                        <h3><i class="fas fa-store"></i> 营销业务利润率</h3>
                        
                        <div class="param-grid">
                            <div class="param-item">
                                <label for="self-operated-margin">自营业务利润率</label>
                                <div class="input-with-unit">
                                    <input type="number" id="self-operated-margin" value="20" step="1">
                                    <div class="input-unit">%</div>
                                </div>
                            </div>
                            
                            <div class="param-item">
                                <label for="agent-margin">代营销业务利润率</label>
                                <div class="input-with-unit">
                                    <input type="number" id="agent-margin" value="5" step="1">
                                    <div class="input-unit">%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="btn-group">
                        <button class="btn-primary" onclick="calculateAll()">
                            <i class="fas fa-calculator"></i> 计算所有情景
                        </button>
                        <button class="btn-secondary" onclick="resetForm()">
                            <i class="fas fa-sync-alt"></i> 重置参数
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <h2><i class="fas fa-project-diagram"></i> 情景参数设置</h2>
                    
                    <div class="scenario-tabs">
                        <div class="scenario-tab conservative active" data-scenario="conservative">保守情景</div>
                        <div class="scenario-tab neutral" data-scenario="neutral">中性情景</div>
                        <div class="scenario-tab optimistic" data-scenario="optimistic">乐观情景</div>
                    </div>
                    
                    <div id="scenario-params">
                        <!-- 保守情景参数 -->
                        <div class="scenario-section scenario-conservative" id="conservative-params">
                            <h3><i class="fas fa-shield-alt"></i> 保守情景参数</h3>
                            
                            <div class="param-grid">
                                <div class="param-item">
                                    <label for="conservative-pallets-y1">第1年平均托盘数</label>
                                    <input type="number" id="conservative-pallets-y1" value="1200" step="100">
                                </div>
                                
                                <div class="param-item">
                                    <label for="conservative-pallets-y2">第2年平均托盘数</label>
                                    <input type="number" id="conservative-pallets-y2" value="2500" step="100">
                                </div>
                                
                                <div class="param-item">
                                    <label for="conservative-pallets-y3">第3年平均托盘数</label>
                                    <input type="number" id="conservative-pallets-y3" value="4000" step="100">
                                </div>
                                
                                <div class="param-item">
                                    <label for="conservative-fulfillment-y1">第1年操作费率</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="conservative-fulfillment-y1" value="50" step="1">
                                        <div class="input-unit">%</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="conservative-fulfillment-y2">第2年操作费率</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="conservative-fulfillment-y2" value="80" step="1">
                                        <div class="input-unit">%</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="conservative-fulfillment-y3">第3年操作费率</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="conservative-fulfillment-y3" value="100" step="1">
                                        <div class="input-unit">%</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="conservative-sublease-sqft">分租面积 (第1-2年)</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="conservative-sublease-sqft" value="20000" step="1000">
                                        <div class="input-unit">平方英尺</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="conservative-sublease-price">分租单价</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="conservative-sublease-price" value="8.5" step="0.5">
                                        <div class="input-unit">CAD/平方英尺/年</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="conservative-sales-y1">第1年总销售额</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="conservative-sales-y1" value="3000000" step="100000">
                                        <div class="input-unit">CAD</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="conservative-sales-y2">第2年总销售额</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="conservative-sales-y2" value="5000000" step="100000">
                                        <div class="input-unit">CAD</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="conservative-sales-y3">第3年总销售额</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="conservative-sales-y3" value="10000000" step="100000">
                                        <div class="input-unit">CAD</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 中性情景参数 -->
                        <div class="scenario-section" id="neutral-params" style="display: none;">
                            <h3><i class="fas fa-balance-scale"></i> 中性情景参数</h3>
                            
                            <div class="param-grid">
                                <div class="param-item">
                                    <label for="neutral-pallets-y1">第1年平均托盘数</label>
                                    <input type="number" id="neutral-pallets-y1" value="1200" step="100">
                                </div>
                                
                                <div class="param-item">
                                    <label for="neutral-pallets-y2">第2年平均托盘数</label>
                                    <input type="number" id="neutral-pallets-y2" value="4000" step="100">
                                </div>
                                
                                <div class="param-item">
                                    <label for="neutral-pallets-y3">第3年平均托盘数</label>
                                    <input type="number" id="neutral-pallets-y3" value="6000" step="100">
                                </div>
                                
                                <div class="param-item">
                                    <label for="neutral-fulfillment-y1">第1年操作费率</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="neutral-fulfillment-y1" value="50" step="1">
                                        <div class="input-unit">%</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="neutral-fulfillment-y2">第2年操作费率</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="neutral-fulfillment-y2" value="80" step="1">
                                        <div class="input-unit">%</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="neutral-fulfillment-y3">第3年操作费率</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="neutral-fulfillment-y3" value="120" step="1">
                                        <div class="input-unit">%</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="neutral-sublease-sqft">分租面积 (仅第1年)</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="neutral-sublease-sqft" value="20000" step="1000">
                                        <div class="input-unit">平方英尺</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="neutral-sublease-price">分租单价</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="neutral-sublease-price" value="8.5" step="0.5">
                                        <div class="input-unit">CAD/平方英尺/年</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="neutral-sales-y1">第1年总销售额</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="neutral-sales-y1" value="3000000" step="100000">
                                        <div class="input-unit">CAD</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="neutral-sales-y2">第2年总销售额</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="neutral-sales-y2" value="8000000" step="100000">
                                        <div class="input-unit">CAD</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="neutral-sales-y3">第3年总销售额</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="neutral-sales-y3" value="12000000" step="100000">
                                        <div class="input-unit">CAD</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 乐观情景参数 -->
                        <div class="scenario-section scenario-optimistic" id="optimistic-params" style="display: none;">
                            <h3><i class="fas fa-rocket"></i> 乐观情景参数</h3>
                            
                            <div class="param-grid">
                                <div class="param-item">
                                    <label for="optimistic-pallets-y1">第1年平均托盘数</label>
                                    <input type="number" id="optimistic-pallets-y1" value="2000" step="100">
                                </div>
                                
                                <div class="param-item">
                                    <label for="optimistic-pallets-y2">第2年平均托盘数</label>
                                    <input type="number" id="optimistic-pallets-y2" value="5000" step="100">
                                </div>
                                
                                <div class="param-item">
                                    <label for="optimistic-pallets-y3">第3年平均托盘数</label>
                                    <input type="number" id="optimistic-pallets-y3" value="7000" step="100">
                                </div>
                                
                                <div class="param-item">
                                    <label for="optimistic-fulfillment-y1">第1年操作费率</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="optimistic-fulfillment-y1" value="80" step="1">
                                        <div class="input-unit">%</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="optimistic-fulfillment-y2">第2年操作费率</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="optimistic-fulfillment-y2" value="100" step="1">
                                        <div class="input-unit">%</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="optimistic-fulfillment-y3">第3年操作费率</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="optimistic-fulfillment-y3" value="120" step="1">
                                        <div class="input-unit">%</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="optimistic-sublease-sqft">分租面积 (仅第1年)</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="optimistic-sublease-sqft" value="20000" step="1000">
                                        <div class="input-unit">平方英尺</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="optimistic-sublease-price">分租单价</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="optimistic-sublease-price" value="8.5" step="0.5">
                                        <div class="input-unit">CAD/平方英尺/年</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="optimistic-sales-y1">第1年总销售额</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="optimistic-sales-y1" value="5000000" step="100000">
                                        <div class="input-unit">CAD</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="optimistic-sales-y2">第2年总销售额</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="optimistic-sales-y2" value="10000000" step="100000">
                                        <div class="input-unit">CAD</div>
                                    </div>
                                </div>
                                
                                <div class="param-item">
                                    <label for="optimistic-sales-y3">第3年总销售额</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="optimistic-sales-y3" value="15000000" step="100000">
                                        <div class="input-unit">CAD</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 预测结果 -->
        <div class="tab-content" id="results-tab">
            <div class="card">
                <h2><i class="fas fa-chart-bar"></i> 多情景财务预测结果</h2>
                
                <div class="scenario-tabs">
                    <div class="scenario-tab conservative active" data-scenario="conservative-results">保守情景</div>
                    <div class="scenario-tab neutral" data-scenario="neutral-results">中性情景</div>
                    <div class="scenario-tab optimistic" data-scenario="optimistic-results">乐观情景</div>
                </div>
                
                <div id="scenario-results">
                    <!-- 保守情景结果 -->
                    <div id="conservative-results">
                        <h3><i class="fas fa-shield-alt"></i> 保守情景财务预测</h3>
                        
                        <table class="financial-table">
                            <thead>
                                <tr>
                                    <th>项目</th>
                                    <th>第1年</th>
                                    <th>第2年</th>
                                    <th>第3年</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td colspan="4" style="background: #f1f8e9; font-weight: bold;">营业收入与毛利</td>
                                </tr>
                                <tr>
                                    <td>平均每月托盘数</td>
                                    <td id="conservative-pallets-y1-result">1,200</td>
                                    <td id="conservative-pallets-y2-result">2,500</td>
                                    <td id="conservative-pallets-y3-result">4,000</td>
                                </tr>
                                <tr>
                                    <td>月均仓储收入 ($20/pallet)</td>
                                    <td>
                                        <div id="conservative-storage-y1">$32,400</div>
                                        <div class="calculation-formula" id="conservative-storage-y1-calculation">1200 × $20 × 1.35</div>
                                    </td>
                                    <td>
                                        <div id="conservative-storage-y2">$67,500</div>
                                        <div class="calculation-formula" id="conservative-storage-y2-calculation">2500 × $20 × 1.35</div>
                                    </td>
                                    <td>
                                        <div id="conservative-storage-y3">$108,000</div>
                                        <div class="calculation-formula" id="conservative-storage-y3-calculation">4000 × $20 × 1.35</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>月均操作收入</td>
                                    <td>
                                        <div id="conservative-fulfillment-y1-result">$16,200</div>
                                        <div class="calculation-formula" id="conservative-fulfillment-y1-calculation">$32,400 × 50%</div>
                                    </td>
                                    <td>
                                        <div id="conservative-fulfillment-y2-result">$54,000</div>
                                        <div class="calculation-formula" id="conservative-fulfillment-y2-calculation">$67,500 × 80%</div>
                                    </td>
                                    <td>
                                        <div id="conservative-fulfillment-y3-result">$108,000</div>
                                        <div class="calculation-formula" id="conservative-fulfillment-y3-calculation">$108,000 × 100%</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>分租收入</td>
                                    <td>
                                        <div id="conservative-sublease-y1">$14,167</div>
                                        <div class="calculation-formula" id="conservative-sublease-y1-calculation">20,000 × $8.5 ÷ 12</div>
                                    </td>
                                    <td>
                                        <div id="conservative-sublease-y2">$14,167</div>
                                        <div class="calculation-formula" id="conservative-sublease-y2-calculation">20,000 × $8.5 ÷ 12</div>
                                    </td>
                                    <td>
                                        <div id="conservative-sublease-y3">$0</div>
                                        <div class="calculation-formula">第3年无分租</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>小计: 仓储服务收入</strong></td>
                                    <td id="conservative-storage-total-y1">$62,767</td>
                                    <td id="conservative-storage-total-y2">$135,667</td>
                                    <td id="conservative-storage-total-y3">$216,000</td>
                                </tr>
                                <tr>
                                    <td>月均营销业务毛利</td>
                                    <td>
                                        <div id="conservative-marketing-y1">$25,000</div>
                                        <div class="calculation-formula" id="conservative-marketing-y1-calculation">($3M × 1/3 × 20% + $3M × 2/3 × 5%) ÷ 12</div>
                                    </td>
                                    <td>
                                        <div id="conservative-marketing-y2">$41,667</div>
                                        <div class="calculation-formula" id="conservative-marketing-y2-calculation">($5M × 1/3 × 20% + $5M × 2/3 × 5%) ÷ 12</div>
                                    </td>
                                    <td>
                                        <div id="conservative-marketing-y3">$83,333</div>
                                        <div class="calculation-formula" id="conservative-marketing-y3-calculation">($10M × 1/3 × 20% + $10M × 2/3 × 5%) ÷ 12</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>月均总毛利</strong></td>
                                    <td id="conservative-total-gross-y1">$87,767</td>
                                    <td id="conservative-total-gross-y2">$177,334</td>
                                    <td id="conservative-total-gross-y3">$299,333</td>
                                </tr>
                                <tr>
                                    <td><strong>年化总毛利</strong></td>
                                    <td id="conservative-annual-gross-y1">$1,053,204</td>
                                    <td id="conservative-annual-gross-y2">$2,128,008</td>
                                    <td id="conservative-annual-gross-y3">$3,591,996</td>
                                </tr>
                                <tr>
                                    <td colspan="4" style="background: #ffebee; font-weight: bold;">运营成本</td>
                                </tr>
                                <tr>
                                    <td>月均固定成本</td>
                                    <td id="conservative-fixed-cost-y1">$60,833</td>
                                    <td id="conservative-fixed-cost-y2">$60,833</td>
                                    <td id="conservative-fixed-cost-y3">$60,833</td>
                                </tr>
                                <tr>
                                    <td><strong>月均总成本</strong></td>
                                    <td id="conservative-total-cost-y1">$60,833</td>
                                    <td id="conservative-total-cost-y2">$60,833</td>
                                    <td id="conservative-total-cost-y3">$60,833</td>
                                </tr>
                                <tr>
                                    <td colspan="4" style="background: #e8f5e9; font-weight: bold;">利润分析</td>
                                </tr>
                                <tr>
                                    <td><strong>月均净利润 (税前)</strong></td>
                                    <td id="conservative-net-profit-y1" class="value-positive">$26,934</td>
                                    <td id="conservative-net-profit-y2" class="value-positive">$116,501</td>
                                    <td id="conservative-net-profit-y3" class="value-positive">$238,500</td>
                                </tr>
                                <tr>
                                    <td><strong>年化净利润</strong></td>
                                    <td id="conservative-annual-net-y1" class="value-positive">$323,208</td>
                                    <td id="conservative-annual-net-y2" class="value-positive">$1,398,012</td>
                                    <td id="conservative-annual-net-y3" class="value-positive">$2,862,000</td>
                                </tr>
                                <tr>
                                    <td><strong>累计净利润</strong></td>
                                    <td id="conservative-cumulative-y1" class="value-positive">$323,208</td>
                                    <td id="conservative-cumulative-y2" class="value-positive">$1,721,220</td>
                                    <td id="conservative-cumulative-y3" class="value-positive">$4,583,220</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- 中性情景结果 -->
                    <div id="neutral-results" style="display: none;">
                        <h3><i class="fas fa-balance-scale"></i> 中性情景财务预测</h3>
                        
                        <table class="financial-table">
                            <thead>
                                <tr>
                                    <th>项目</th>
                                    <th>第1年</th>
                                    <th>第2年</th>
                                    <th>第3年</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td colspan="4" style="background: #f1f8e9; font-weight: bold;">营业收入与毛利</td>
                                </tr>
                                <tr>
                                    <td>平均每月托盘数</td>
                                    <td id="neutral-pallets-y1-result">1,200</td>
                                    <td id="neutral-pallets-y2-result">4,000</td>
                                    <td id="neutral-pallets-y3-result">6,000</td>
                                </tr>
                                <tr>
                                    <td>月均仓储收入 ($20/pallet)</td>
                                    <td>
                                        <div id="neutral-storage-y1">$32,400</div>
                                        <div class="calculation-formula">1200 × $20 × 1.35</div>
                                    </td>
                                    <td>
                                        <div id="neutral-storage-y2">$108,000</div>
                                        <div class="calculation-formula">4000 × $20 × 1.35</div>
                                    </td>
                                    <td>
                                        <div id="neutral-storage-y3">$162,000</div>
                                        <div class="calculation-formula">6000 × $20 × 1.35</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>月均操作收入</td>
                                    <td>
                                        <div id="neutral-fulfillment-y1-result">$16,200</div>
                                        <div class="calculation-formula">$32,400 × 50%</div>
                                    </td>
                                    <td>
                                        <div id="neutral-fulfillment-y2-result">$86,400</div>
                                        <div class="calculation-formula">$108,000 × 80%</div>
                                    </td>
                                    <td>
                                        <div id="neutral-fulfillment-y3-result">$194,400</div>
                                        <div class="calculation-formula">$162,000 × 120%</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>分租收入</td>
                                    <td>
                                        <div id="neutral-sublease-y1">$14,167</div>
                                        <div class="calculation-formula">20,000 × $8.5 ÷ 12</div>
                                    </td>
                                    <td>
                                        <div id="neutral-sublease-y2">$0</div>
                                        <div class="calculation-formula">第2年无分租</div>
                                    </td>
                                    <td>
                                        <div id="neutral-sublease-y3">$0</div>
                                        <div class="calculation-formula">第3年无分租</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>小计: 仓储服务收入</strong></td>
                                    <td id="neutral-storage-total-y1">$62,767</td>
                                    <td id="neutral-storage-total-y2">$194,400</td>
                                    <td id="neutral-storage-total-y3">$356,400</td>
                                </tr>
                                <tr>
                                    <td>月均营销业务毛利</td>
                                    <td>
                                        <div id="neutral-marketing-y1">$25,000</div>
                                        <div class="calculation-formula">($3M × 1/3 × 20% + $3M × 2/3 × 5%) ÷ 12</div>
                                    </td>
                                    <td>
                                        <div id="neutral-marketing-y2">$66,667</div>
                                        <div class="calculation-formula">($8M × 1/3 × 20% + $8M × 2/3 × 5%) ÷ 12</div>
                                    </td>
                                    <td>
                                        <div id="neutral-marketing-y3">$100,000</div>
                                        <div class="calculation-formula">($12M × 1/3 × 20% + $12M × 2/3 × 5%) ÷ 12</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>月均总毛利</strong></td>
                                    <td id="neutral-total-gross-y1">$87,767</td>
                                    <td id="neutral-total-gross-y2">$261,067</td>
                                    <td id="neutral-total-gross-y3">$456,400</td>
                                </tr>
                                <tr>
                                    <td><strong>年化总毛利</strong></td>
                                    <td id="neutral-annual-gross-y1">$1,053,204</td>
                                    <td id="neutral-annual-gross-y2">$3,132,804</td>
                                    <td id="neutral-annual-gross-y3">$5,476,800</td>
                                </tr>
                                <tr>
                                    <td colspan="4" style="background: #ffebee; font-weight: bold;">运营成本</td>
                                </tr>
                                <tr>
                                    <td>月均固定成本</td>
                                    <td id="neutral-fixed-cost-y1">$60,833</td>
                                    <td id="neutral-fixed-cost-y2">$60,833</td>
                                    <td id="neutral-fixed-cost-y3">$60,833</td>
                                </tr>
                                <tr>
                                    <td><strong>月均总成本</strong></td>
                                    <td id="neutral-total-cost-y1">$60,833</td>
                                    <td id="neutral-total-cost-y2">$60,833</td>
                                    <td id="neutral-total-cost-y3">$60,833</td>
                                </tr>
                                <tr>
                                    <td colspan="4" style="background: #e8f5e9; font-weight: bold;">利润分析</td>
                                </tr>
                                <tr>
                                    <td><strong>月均净利润 (税前)</strong></td>
                                    <td id="neutral-net-profit-y1" class="value-positive">$26,934</td>
                                    <td id="neutral-net-profit-y2" class="value-positive">$200,234</td>
                                    <td id="neutral-net-profit-y3" class="value-positive">$395,567</td>
                                </tr>
                                <tr>
                                    <td><strong>年化净利润</strong></td>
                                    <td id="neutral-annual-net-y1" class="value-positive">$323,208</td>
                                    <td id="neutral-annual-net-y2" class="value-positive">$2,402,808</td>
                                    <td id="neutral-annual-net-y3" class="value-positive">$4,746,804</td>
                                </tr>
                                <tr>
                                    <td><strong>累计净利润</strong></td>
                                    <td id="neutral-cumulative-y1" class="value-positive">$323,208</td>
                                    <td id="neutral-cumulative-y2" class="value-positive">$2,726,016</td>
                                    <td id="neutral-cumulative-y3" class="value-positive">$7,472,820</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- 乐观情景结果 -->
                    <div id="optimistic-results" style="display: none;">
                        <h3><i class="fas fa-rocket"></i> 乐观情景财务预测</h3>
                        
                        <table class="financial-table">
                            <thead>
                                <tr>
                                    <th>项目</th>
                                    <th>第1年</th>
                                    <th>第2年</th>
                                    <th>第3年</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td colspan="4" style="background: #f1f8e9; font-weight: bold;">营业收入与毛利</td>
                                </tr>
                                <tr>
                                    <td>平均每月托盘数</td>
                                    <td id="optimistic-pallets-y1-result">2,000</td>
                                    <td id="optimistic-pallets-y2-result">5,000</td>
                                    <td id="optimistic-pallets-y3-result">7,000</td>
                                </tr>
                                <tr>
                                    <td>月均仓储收入 ($20/pallet)</td>
                                    <td>
                                        <div id="optimistic-storage-y1">$54,000</div>
                                        <div class="calculation-formula">2000 × $20 × 1.35</div>
                                    </td>
                                    <td>
                                        <div id="optimistic-storage-y2">$135,000</div>
                                        <div class="calculation-formula">5000 × $20 × 1.35</div>
                                    </td>
                                    <td>
                                        <div id="optimistic-storage-y3">$189,000</div>
                                        <div class="calculation-formula">7000 × $20 × 1.35</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>月均操作收入</td>
                                    <td>
                                        <div id="optimistic-fulfillment-y1-result">$43,200</div>
                                        <div class="calculation-formula">$54,000 × 80%</div>
                                    </td>
                                    <td>
                                        <div id="optimistic-fulfillment-y2-result">$135,000</div>
                                        <div class="calculation-formula">$135,000 × 100%</div>
                                    </td>
                                    <td>
                                        <div id="optimistic-fulfillment-y3-result">$226,800</div>
                                        <div class="calculation-formula">$189,000 × 120%</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>分租收入</td>
                                    <td>
                                        <div id="optimistic-sublease-y1">$14,167</div>
                                        <div class="calculation-formula">20,000 × $8.5 ÷ 12</div>
                                    </td>
                                    <td>
                                        <div id="optimistic-sublease-y2">$0</div>
                                        <div class="calculation-formula">第2年无分租</div>
                                    </td>
                                    <td>
                                        <div id="optimistic-sublease-y3">$0</div>
                                        <div class="calculation-formula">第3年无分租</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>小计: 仓储服务收入</strong></td>
                                    <td id="optimistic-storage-total-y1">$111,367</td>
                                    <td id="optimistic-storage-total-y2">$270,000</td>
                                    <td id="optimistic-storage-total-y3">$415,800</td>
                                </tr>
                                <tr>
                                    <td>月均营销业务毛利</td>
                                    <td>
                                        <div id="optimistic-marketing-y1">$41,667</div>
                                        <div class="calculation-formula">($5M × 1/3 × 20% + $5M × 2/3 × 5%) ÷ 12</div>
                                    </td>
                                    <td>
                                        <div id="optimistic-marketing-y2">$83,333</div>
                                        <div class="calculation-formula">($10M × 1/3 × 20% + $10M × 2/3 × 5%) ÷ 12</div>
                                    </td>
                                    <td>
                                        <div id="optimistic-marketing-y3">$125,000</div>
                                        <div class="calculation-formula">($15M × 1/3 × 20% + $15M × 2/3 × 5%) ÷ 12</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>月均总毛利</strong></td>
                                    <td id="optimistic-total-gross-y1">$153,034</td>
                                    <td id="optimistic-total-gross-y2">$353,333</td>
                                    <td id="optimistic-total-gross-y3">$540,800</td>
                                </tr>
                                <tr>
                                    <td><strong>年化总毛利</strong></td>
                                    <td id="optimistic-annual-gross-y1">$1,836,408</td>
                                    <td id="optimistic-annual-gross-y2">$4,239,996</td>
                                    <td id="optimistic-annual-gross-y3">$6,489,600</td>
                                </tr>
                                <tr>
                                    <td colspan="4" style="background: #ffebee; font-weight: bold;">运营成本</td>
                                </tr>
                                <tr>
                                    <td>月均固定成本</td>
                                    <td id="optimistic-fixed-cost-y1">$60,833</td>
                                    <td id="optimistic-fixed-cost-y2">$60,833</td>
                                    <td id="optimistic-fixed-cost-y3">$60,833</td>
                                </tr>
                                <tr>
                                    <td><strong>月均总成本</strong></td>
                                    <td id="optimistic-total-cost-y1">$60,833</td>
                                    <td id="optimistic-total-cost-y2">$60,833</td>
                                    <td id="optimistic-total-cost-y3">$60,833</td>
                                </tr>
                                <tr>
                                    <td colspan="4" style="background: #e8f5e9; font-weight: bold;">利润分析</td>
                                </tr>
                                <tr>
                                    <td><strong>月均净利润 (税前)</strong></td>
                                    <td id="optimistic-net-profit-y1" class="value-positive">$92,201</td>
                                    <td id="optimistic-net-profit-y2" class="value-positive">$292,500</td>
                                    <td id="optimistic-net-profit-y3" class="value-positive">$479,967</td>
                                </tr>
                                <tr>
                                    <td><strong>年化净利润</strong></td>
                                    <td id="optimistic-annual-net-y1" class="value-positive">$1,106,412</td>
                                    <td id="optimistic-annual-net-y2" class="value-positive">$3,510,000</td>
                                    <td id="optimistic-annual-net-y3" class="value-positive">$5,759,604</td>
                                </tr>
                                <tr>
                                    <td><strong>累计净利润</strong></td>
                                    <td id="optimistic-cumulative-y1" class="value-positive">$1,106,412</td>
                                    <td id="optimistic-cumulative-y2" class="value-positive">$4,616,412</td>
                                    <td id="optimistic-cumulative-y3" class="value-positive">$10,376,016</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="scenarioChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- 投资分析 -->
        <div class="tab-content" id="analysis-tab">
            <div class="dashboard">
                <div class="card">
                    <h2><i class="fas fa-chart-pie"></i> 投资回报分析</h2>
                    
                    <div class="scenario-tabs">
                        <div class="scenario-tab conservative active" data-scenario="conservative-roi">保守情景</div>
                        <div class="scenario-tab neutral" data-scenario="neutral-roi">中性情景</div>
                        <div class="scenario-tab optimistic" data-scenario="optimistic-roi">乐观情景</div>
                    </div>
                    
                    <div id="roi-analysis">
                        <!-- 保守情景ROI分析 -->
                        <div id="conservative-roi">
                            <h3><i class="fas fa-shield-alt"></i> 保守情景投资回报分析</h3>
                            
                            <div class="summary-card">
                                <div class="summary-item">
                                    <div class="summary-label">达到盈亏平衡点</div>
                                    <div class="summary-value" id="conservative-break-even">约第8个月</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">投资回收周期</div>
                                    <div class="summary-value" id="conservative-payback">约16个月</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">第3年预期年净利润</div>
                                    <div class="summary-value profit" id="conservative-profit-y3">$2.86M</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">第3年ROI</div>
                                    <div class="summary-value profit" id="conservative-roi-y3">477.0%</div>
                                </div>
                            </div>
                            
                            <h3><i class="fas fa-coins"></i> 估值分析</h3>
                            
                            <div class="summary-card">
                                <div class="summary-item">
                                    <div class="summary-label">潜在退出价值 (5倍PE)</div>
                                    <div class="summary-value" id="conservative-valuation">$14.31M</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">投资人20%股份价值</div>
                                    <div class="summary-value" id="conservative-investor-value">$2.86M</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">投资增值倍数</div>
                                    <div class="summary-value profit" id="conservative-multiple">4.8x</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">年化回报率</div>
                                    <div class="summary-value profit" id="conservative-annualized">69.1%</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 中性情景ROI分析 -->
                        <div id="neutral-roi" style="display: none;">
                            <h3><i class="fas fa-balance-scale"></i> 中性情景投资回报分析</h3>
                            
                            <div class="summary-card">
                                <div class="summary-item">
                                    <div class="summary-label">达到盈亏平衡点</div>
                                    <div class="summary-value" id="neutral-break-even">约第8个月</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">投资回收周期</div>
                                    <div class="summary-value" id="neutral-payback">约14个月</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">第3年预期年净利润</div>
                                    <div class="summary-value profit" id="neutral-profit-y3">$4.75M</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">第3年ROI</div>
                                    <div class="summary-value profit" id="neutral-roi-y3">791.1%</div>
                                </div>
                            </div>
                            
                            <h3><i class="fas fa-coins"></i> 估值分析</h3>
                            
                            <div class="summary-card">
                                <div class="summary-item">
                                    <div class="summary-label">潜在退出价值 (6倍PE)</div>
                                    <div class="summary-value" id="neutral-valuation">$28.48M</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">投资人20%股份价值</div>
                                    <div class="summary-value" id="neutral-investor-value">$5.70M</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">投资增值倍数</div>
                                    <div class="summary-value profit" id="neutral-multiple">9.5x</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">年化回报率</div>
                                    <div class="summary-value profit" id="neutral-annualized">113.8%</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 乐观情景ROI分析 -->
                        <div id="optimistic-roi" style="display: none;">
                            <h3><i class="fas fa-rocket"></i> 乐观情景投资回报分析</h3>
                            
                            <div class="summary-card">
                                <div class="summary-item">
                                    <div class="summary-label">达到盈亏平衡点</div>
                                    <div class="summary-value" id="optimistic-break-even">第4-5个月</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">投资回收周期</div>
                                    <div class="summary-value" id="optimistic-payback">约10个月</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">第3年预期年净利润</div>
                                    <div class="summary-value profit" id="optimistic-profit-y3">$5.76M</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">第3年ROI</div>
                                    <div class="summary-value profit" id="optimistic-roi-y3">959.9%</div>
                                </div>
                            </div>
                            
                            <h3><i class="fas fa-coins"></i> 估值分析</h3>
                            
                            <div class="summary-card">
                                <div class="summary-item">
                                    <div class="summary-label">潜在退出价值 (7倍PE)</div>
                                    <div class="summary-value" id="optimistic-valuation">$40.32M</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">投资人20%股份价值</div>
                                    <div class="summary-value" id="optimistic-investor-value">$8.06M</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">投资增值倍数</div>
                                    <div class="summary-value profit" id="optimistic-multiple">13.4x</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">年化回报率</div>
                                    <div class="summary-value profit" id="optimistic-annualized">144.3%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="roiChart"></canvas>
                    </div>
                </div>
                
                <div class="card">
                    <h2><i class="fas fa-balance-scale"></i> 情景对比分析</h2>
                    
                    <div class="chart-container">
                        <canvas id="comparisonChart"></canvas>
                    </div>
                    
                    <h3><i class="fas fa-star"></i> 情景优势与风险分析</h3>
                    
                    <div class="scenario-section scenario-conservative">
                        <h4><i class="fas fa-shield-alt"></i> 保守情景</h4>
                        <p><strong>优势:</strong> 风险最低，现金流稳定，市场波动影响小</p>
                        <p><strong>风险:</strong> 增长缓慢，可能错过市场机会，回报率相对较低</p>
                        <p><strong>适合:</strong> 风险厌恶型投资者，经济不确定性高时期</p>
                    </div>
                    
                    <div class="scenario-section">
                        <h4><i class="fas fa-balance-scale"></i> 中性情景</h4>
                        <p><strong>优势:</strong> 平衡风险与回报，基于现实市场预期</p>
                        <p><strong>风险:</strong> 可能受到市场波动影响</p>
                        <p><strong>适合:</strong> 大多数投资者，标准市场条件下的合理预期</p>
                    </div>
                    
                    <div class="scenario-section scenario-optimistic">
                        <h4><i class="fas fa-rocket"></i> 乐观情景</h4>
                        <p><strong>优势:</strong> 高增长潜力，最大回报可能性</p>
                        <p><strong>风险:</strong> 需要额外投资扩展产能，市场接受度不确定性</p>
                        <p><strong>适合:</strong> 风险承受能力强，追求高回报的投资者</p>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>© 2025 Fastline业务财务分析系统 | 多情景预测专业版</p>
        </footer>
    </div>

    <script>
        // 全局变量
        let currentScenario = 'conservative';
        let currentScenarioResults = 'conservative-results';
        let currentScenarioROI = 'conservative-roi';
        
        // 情景切换
        document.querySelectorAll('.scenario-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const scenario = this.dataset.scenario;
                
                // 更新参数选项卡
                if (scenario.includes('conservative')) {
                    showScenario('conservative');
                    currentScenario = 'conservative';
                } else if (scenario.includes('neutral')) {
                    showScenario('neutral');
                    currentScenario = 'neutral';
                } else if (scenario.includes('optimistic')) {
                    showScenario('optimistic');
                    currentScenario = 'optimistic';
                }
                
                // 更新结果选项卡
                if (scenario.includes('results')) {
                    showResults(scenario);
                    currentScenarioResults = scenario;
                }
                
                // 更新ROI选项卡
                if (scenario.includes('roi')) {
                    showROI(scenario);
                    currentScenarioROI = scenario;
                }
                
                // 更新活动标签样式
                document.querySelectorAll('.scenario-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
            });
        });
        
        // 显示对应情景参数
        function showScenario(scenario) {
            document.getElementById('conservative-params').style.display = 'none';
            document.getElementById('neutral-params').style.display = 'none';
            document.getElementById('optimistic-params').style.display = 'none';
            document.getElementById(`${scenario}-params`).style.display = 'block';
        }
        
        // 显示对应情景结果
        function showResults(scenario) {
            document.getElementById('conservative-results').style.display = 'none';
            document.getElementById('neutral-results').style.display = 'none';
            document.getElementById('optimistic-results').style.display = 'none';
            document.getElementById(scenario).style.display = 'block';
        }
        
        // 显示对应情景ROI分析
        function showROI(scenario) {
            document.getElementById('conservative-roi').style.display = 'none';
            document.getElementById('neutral-roi').style.display = 'none';
            document.getElementById('optimistic-roi').style.display = 'none';
            document.getElementById(scenario).style.display = 'block';
        }
        
        // 标签切换功能
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // 移除所有活动标签
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                // 添加当前活动标签
                this.classList.add('active');
                
                // 隐藏所有内容
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                // 显示当前内容
                document.getElementById(`${this.dataset.tab}-tab`).classList.add('active');
            });
        });
        
        // 计算所有情景
        function calculateAll() {
            calculateScenario('conservative');
            calculateScenario('neutral');
            calculateScenario('optimistic');
            
            updateCharts();
            
            // 切换到结果选项卡
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelector('[data-tab="results"]').classList.add('active');
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById('results-tab').classList.add('active');
        }
        
        // 计算特定情景
        function calculateScenario(scenario) {
            // 获取基础参数
            const storagePrice = parseFloat(document.getElementById('storage-price').value) || 20;
            const usdCadRate = parseFloat(document.getElementById('usd-cad-rate').value) || 1.35;
            const fixedCost = parseFloat(document.getElementById('fixed-cost').value) || 60833;
            const investmentAmount = parseFloat(document.getElementById('investment-amount').value) || 600000;
            
            // 营销业务利润率
            const selfOperatedMargin = parseFloat(document.getElementById('self-operated-margin').value) || 20;
            const agentMargin = parseFloat(document.getElementById('agent-margin').value) || 5;
            
            // 获取情景特定参数
            const palletsY1 = parseFloat(document.getElementById(`${scenario}-pallets-y1`).value) || 1200;
            const palletsY2 = parseFloat(document.getElementById(`${scenario}-pallets-y2`).value) || 2500;
            const palletsY3 = parseFloat(document.getElementById(`${scenario}-pallets-y3`).value) || 4000;
            const fulfillmentY1 = parseFloat(document.getElementById(`${scenario}-fulfillment-y1`).value) || 50;
            const fulfillmentY2 = parseFloat(document.getElementById(`${scenario}-fulfillment-y2`).value) || 80;
            const fulfillmentY3 = parseFloat(document.getElementById(`${scenario}-fulfillment-y3`).value) || 100;
            const subleaseSqft = parseFloat(document.getElementById(`${scenario}-sublease-sqft`).value) || 20000;
            const subleasePrice = parseFloat(document.getElementById(`${scenario}-sublease-price`).value) || 8.5;
            const salesY1 = parseFloat(document.getElementById(`${scenario}-sales-y1`).value) || 3000000;
            const salesY2 = parseFloat(document.getElementById(`${scenario}-sales-y2`).value) || 5000000;
            const salesY3 = parseFloat(document.getElementById(`${scenario}-sales-y3`).value) || 10000000;
            
            // 计算分租收入（每月）
            let subleaseMonthlyY1 = 0, subleaseMonthlyY2 = 0, subleaseMonthlyY3 = 0;
            
            if (scenario === 'conservative') {
                // 保守情景：第1-2年有分租
                subleaseMonthlyY1 = (subleaseSqft * subleasePrice) / 12;
                subleaseMonthlyY2 = (subleaseSqft * subleasePrice) / 12;
                subleaseMonthlyY3 = 0;
            } else {
                // 中性和乐观情景：仅第1年有分租
                subleaseMonthlyY1 = (subleaseSqft * subleasePrice) / 12;
                subleaseMonthlyY2 = 0;
                subleaseMonthlyY3 = 0;
            }
            
            // 计算营销业务毛利
            // 自营部分占1/3，代营销部分占2/3
            const selfOperatedY1 = (salesY1 / 3) * (selfOperatedMargin / 100);
            const agentY1 = (salesY1 * 2 / 3) * (agentMargin / 100);
            const marketingY1 = (selfOperatedY1 + agentY1) / 12; // 月均
            
            const selfOperatedY2 = (salesY2 / 3) * (selfOperatedMargin / 100);
            const agentY2 = (salesY2 * 2 / 3) * (agentMargin / 100);
            const marketingY2 = (selfOperatedY2 + agentY2) / 12; // 月均
            
            const selfOperatedY3 = (salesY3 / 3) * (selfOperatedMargin / 100);
            const agentY3 = (salesY3 * 2 / 3) * (agentMargin / 100);
            const marketingY3 = (selfOperatedY3 + agentY3) / 12; // 月均
            
            // 计算各年收入
            const storageY1 = (palletsY1 * storagePrice * usdCadRate);
            const storageY2 = (palletsY2 * storagePrice * usdCadRate);
            const storageY3 = (palletsY3 * storagePrice * usdCadRate);
            
            const fulfillmentY1Result = storageY1 * (fulfillmentY1 / 100);
            const fulfillmentY2Result = storageY2 * (fulfillmentY2 / 100);
            const fulfillmentY3Result = storageY3 * (fulfillmentY3 / 100);
            
            const storageTotalY1 = storageY1 + fulfillmentY1Result + subleaseMonthlyY1;
            const storageTotalY2 = storageY2 + fulfillmentY2Result + subleaseMonthlyY2;
            const storageTotalY3 = storageY3 + fulfillmentY3Result + subleaseMonthlyY3;
            
            // 计算总毛利
            const totalGrossY1 = storageTotalY1 + marketingY1;
            const totalGrossY2 = storageTotalY2 + marketingY2;
            const totalGrossY3 = storageTotalY3 + marketingY3;
            
            // 计算成本
            const totalCostY1 = fixedCost;
            const totalCostY2 = fixedCost;
            const totalCostY3 = fixedCost;
            
            // 计算净利润
            const netProfitY1 = totalGrossY1 - totalCostY1;
            const netProfitY2 = totalGrossY2 - totalCostY2;
            const netProfitY3 = totalGrossY3 - totalCostY3;
            
            // 年化数据
            const annualGrossY1 = totalGrossY1 * 12;
            const annualGrossY2 = totalGrossY2 * 12;
            const annualGrossY3 = totalGrossY3 * 12;
            
            const annualNetY1 = netProfitY1 * 12;
            const annualNetY2 = netProfitY2 * 12;
            const annualNetY3 = netProfitY3 * 12;
            
            const cumulativeY1 = annualNetY1;
            const cumulativeY2 = annualNetY1 + annualNetY2;
            const cumulativeY3 = annualNetY1 + annualNetY2 + annualNetY3;
            
            // 更新结果显示
            document.getElementById(`${scenario}-pallets-y1-result`).textContent = palletsY1.toLocaleString();
            document.getElementById(`${scenario}-pallets-y2-result`).textContent = palletsY2.toLocaleString();
            document.getElementById(`${scenario}-pallets-y3-result`).textContent = palletsY3.toLocaleString();
            
            document.getElementById(`${scenario}-storage-y1`).textContent = `$${Math.round(storageY1).toLocaleString()}`;
            document.getElementById(`${scenario}-storage-y2`).textContent = `$${Math.round(storageY2).toLocaleString()}`;
            document.getElementById(`${scenario}-storage-y3`).textContent = `$${Math.round(storageY3).toLocaleString()}`;
            
            document.getElementById(`${scenario}-storage-y1-calculation`).textContent = `${palletsY1} × $${storagePrice} × ${usdCadRate}`;
            document.getElementById(`${scenario}-storage-y2-calculation`).textContent = `${palletsY2} × $${storagePrice} × ${usdCadRate}`;
            document.getElementById(`${scenario}-storage-y3-calculation`).textContent = `${palletsY3} × $${storagePrice} × ${usdCadRate}`;
            
            document.getElementById(`${scenario}-fulfillment-y1-result`).textContent = `$${Math.round(fulfillmentY1Result).toLocaleString()}`;
            document.getElementById(`${scenario}-fulfillment-y2-result`).textContent = `$${Math.round(fulfillmentY2Result).toLocaleString()}`;
            document.getElementById(`${scenario}-fulfillment-y3-result`).textContent = `$${Math.round(fulfillmentY3Result).toLocaleString()}`;
            
            document.getElementById(`${scenario}-fulfillment-y1-calculation`).textContent = `$${Math.round(storageY1).toLocaleString()} × ${fulfillmentY1}%`;
            document.getElementById(`${scenario}-fulfillment-y2-calculation`).textContent = `$${Math.round(storageY2).toLocaleString()} × ${fulfillmentY2}%`;
            document.getElementById(`${scenario}-fulfillment-y3-calculation`).textContent = `$${Math.round(storageY3).toLocaleString()} × ${fulfillmentY3}%`;
            
            document.getElementById(`${scenario}-sublease-y1`).textContent = `$${Math.round(subleaseMonthlyY1).toLocaleString()}`;
            document.getElementById(`${scenario}-sublease-y2`).textContent = `$${Math.round(subleaseMonthlyY2).toLocaleString()}`;
            document.getElementById(`${scenario}-sublease-y3`).textContent = `$${Math.round(subleaseMonthlyY3).toLocaleString()}`;
            
            document.getElementById(`${scenario}-sublease-y1-calculation`).textContent = `${subleaseSqft} × $${subleasePrice} ÷ 12`;
            document.getElementById(`${scenario}-sublease-y2-calculation`).textContent = `${subleaseSqft} × $${subleasePrice} ÷ 12`;
            
            document.getElementById(`${scenario}-storage-total-y1`).textContent = `$${Math.round(storageTotalY1).toLocaleString()}`;
            document.getElementById(`${scenario}-storage-total-y2`).textContent = `$${Math.round(storageTotalY2).toLocaleString()}`;
            document.getElementById(`${scenario}-storage-total-y3`).textContent = `$${Math.round(storageTotalY3).toLocaleString()}`;
            
            document.getElementById(`${scenario}-marketing-y1`).textContent = `$${Math.round(marketingY1).toLocaleString()}`;
            document.getElementById(`${scenario}-marketing-y2`).textContent = `$${Math.round(marketingY2).toLocaleString()}`;
            document.getElementById(`${scenario}-marketing-y3`).textContent = `$${Math.round(marketingY3).toLocaleString()}`;
            
            document.getElementById(`${scenario}-marketing-y1-calculation`).textContent = `($${(salesY1/1000000).toFixed(1)}M × 1/3 × ${selfOperatedMargin}% + $${(salesY1/1000000).toFixed(1)}M × 2/3 × ${agentMargin}%) ÷ 12`;
            document.getElementById(`${scenario}-marketing-y2-calculation`).textContent = `($${(salesY2/1000000).toFixed(1)}M × 1/3 × ${selfOperatedMargin}% + $${(salesY2/1000000).toFixed(1)}M × 2/3 × ${agentMargin}%) ÷ 12`;
            document.getElementById(`${scenario}-marketing-y3-calculation`).textContent = `($${(salesY3/1000000).toFixed(1)}M × 1/3 × ${selfOperatedMargin}% + $${(salesY3/1000000).toFixed(1)}M × 2/3 × ${agentMargin}%) ÷ 12`;
            
            document.getElementById(`${scenario}-total-gross-y1`).textContent = `$${Math.round(totalGrossY1).toLocaleString()}`;
            document.getElementById(`${scenario}-total-gross-y2`).textContent = `$${Math.round(totalGrossY2).toLocaleString()}`;
            document.getElementById(`${scenario}-total-gross-y3`).textContent = `$${Math.round(totalGrossY3).toLocaleString()}`;
            
            document.getElementById(`${scenario}-annual-gross-y1`).textContent = `$${Math.round(annualGrossY1).toLocaleString()}`;
            document.getElementById(`${scenario}-annual-gross-y2`).textContent = `$${Math.round(annualGrossY2).toLocaleString()}`;
            document.getElementById(`${scenario}-annual-gross-y3`).textContent = `$${Math.round(annualGrossY3).toLocaleString()}`;
            
            document.getElementById(`${scenario}-fixed-cost-y1`).textContent = `$${Math.round(fixedCost).toLocaleString()}`;
            document.getElementById(`${scenario}-fixed-cost-y2`).textContent = `$${Math.round(fixedCost).toLocaleString()}`;
            document.getElementById(`${scenario}-fixed-cost-y3`).textContent = `$${Math.round(fixedCost).toLocaleString()}`;
            
            document.getElementById(`${scenario}-total-cost-y1`).textContent = `$${Math.round(totalCostY1).toLocaleString()}`;
            document.getElementById(`${scenario}-total-cost-y2`).textContent = `$${Math.round(totalCostY2).toLocaleString()}`;
            document.getElementById(`${scenario}-total-cost-y3`).textContent = `$${Math.round(totalCostY3).toLocaleString()}`;
            
            // 更新净利润显示（添加颜色类）
            const netY1Elem = document.getElementById(`${scenario}-net-profit-y1`);
            const netY2Elem = document.getElementById(`${scenario}-net-profit-y2`);
            const netY3Elem = document.getElementById(`${scenario}-net-profit-y3`);
            
            netY1Elem.textContent = `$${Math.round(netProfitY1).toLocaleString()}`;
            netY2Elem.textContent = `$${Math.round(netProfitY2).toLocaleString()}`;
            netY3Elem.textContent = `$${Math.round(netProfitY3).toLocaleString()}`;
            
            netY1Elem.className = netProfitY1 >= 0 ? 'value-positive' : 'value-negative';
            netY2Elem.className = netProfitY2 >= 0 ? 'value-positive' : 'value-negative';
            netY3Elem.className = netProfitY3 >= 0 ? 'value-positive' : 'value-negative';
            
            document.getElementById(`${scenario}-annual-net-y1`).textContent = `$${Math.round(annualNetY1).toLocaleString()}`;
            document.getElementById(`${scenario}-annual-net-y2`).textContent = `$${Math.round(annualNetY2).toLocaleString()}`;
            document.getElementById(`${scenario}-annual-net-y3`).textContent = `$${Math.round(annualNetY3).toLocaleString()}`;
            
            document.getElementById(`${scenario}-cumulative-y1`).textContent = `$${Math.round(cumulativeY1).toLocaleString()}`;
            document.getElementById(`${scenario}-cumulative-y2`).textContent = `$${Math.round(cumulativeY2).toLocaleString()}`;
            document.getElementById(`${scenario}-cumulative-y3`).textContent = `$${Math.round(cumulativeY3).toLocaleString()}`;
            
            // 计算ROI指标
            calculateROI(scenario, annualNetY3, investmentAmount);
        }
        
        // 计算ROI指标
        function calculateROI(scenario, annualNetY3, investmentAmount) {
            // 计算ROI
            const roi = (annualNetY3 / investmentAmount * 100).toFixed(1);
            
            // 根据情景使用不同的PE倍数
            let peMultiple;
            if (scenario === 'conservative') {
                peMultiple = 5;
            } else if (scenario === 'neutral') {
                peMultiple = 6;
            } else {
                peMultiple = 7;
            }
            
            // 计算估值
            const valuation = annualNetY3 * peMultiple;
            const investorValue = valuation * 0.2;
            const multiple = (investorValue / investmentAmount).toFixed(1);
            
            // 年化回报率 (简化计算)
            const annualized = Math.pow(investorValue / investmentAmount, 1/3) - 1;
            const annualizedPercent = (annualized * 100).toFixed(1);
            
            // 更新ROI显示
            document.getElementById(`${scenario}-profit-y3`).textContent = `$${(annualNetY3 / 1000000).toFixed(2)}M`;
            document.getElementById(`${scenario}-roi-y3`).textContent = `${roi}%`;
            
            document.getElementById(`${scenario}-valuation`).textContent = `$${(valuation / 1000000).toFixed(2)}M`;
            document.getElementById(`${scenario}-investor-value`).textContent = `$${(investorValue / 1000000).toFixed(2)}M`;
            document.getElementById(`${scenario}-multiple`).textContent = `${multiple}x`;
            document.getElementById(`${scenario}-annualized`).textContent = `${annualizedPercent}%`;
            
            // 根据情景设置不同的回收期和盈亏平衡点
            if (scenario === 'conservative') {
                document.getElementById(`${scenario}-break-even`).textContent = '约第8个月';
                document.getElementById(`${scenario}-payback`).textContent = '约16个月';
            } else if (scenario === 'neutral') {
                document.getElementById(`${scenario}-break-even`).textContent = '约第8个月';
                document.getElementById(`${scenario}-payback`).textContent = '约14个月';
            } else if (scenario === 'optimistic') {
                document.getElementById(`${scenario}-break-even`).textContent = '第4-5个月';
                document.getElementById(`${scenario}-payback`).textContent = '约10个月';
            }
        }
        
        // 更新图表
        function updateCharts() {
            // 获取各情景的净利润数据
            const conservativeNet = [
                parseFloat(document.getElementById('conservative-annual-net-y1').textContent.replace('$', '').replace(/,/g, '')),
                parseFloat(document.getElementById('conservative-annual-net-y2').textContent.replace('$', '').replace(/,/g, '')),
                parseFloat(document.getElementById('conservative-annual-net-y3').textContent.replace('$', '').replace(/,/g, ''))
            ];
            
            const neutralNet = [
                parseFloat(document.getElementById('neutral-annual-net-y1').textContent.replace('$', '').replace(/,/g, '')),
                parseFloat(document.getElementById('neutral-annual-net-y2').textContent.replace('$', '').replace(/,/g, '')),
                parseFloat(document.getElementById('neutral-annual-net-y3').textContent.replace('$', '').replace(/,/g, ''))
            ];
            
            const optimisticNet = [
                parseFloat(document.getElementById('optimistic-annual-net-y1').textContent.replace('$', '').replace(/,/g, '')),
                parseFloat(document.getElementById('optimistic-annual-net-y2').textContent.replace('$', '').replace(/,/g, '')),
                parseFloat(document.getElementById('optimistic-annual-net-y3').textContent.replace('$', '').replace(/,/g, ''))
            ];
            
            // 创建情景对比图表
            const scenarioCtx = document.getElementById('scenarioChart').getContext('2d');
            if (window.scenarioChartInstance) {
                window.scenarioChartInstance.destroy();
            }
            window.scenarioChartInstance = new Chart(scenarioCtx, {
                type: 'bar',
                data: {
                    labels: ['第1年', '第2年', '第3年'],
                    datasets: [
                        {
                            label: '保守情景',
                            data: conservativeNet,
                            backgroundColor: 'rgba(231, 76, 60, 0.7)',
                            borderColor: 'rgba(231, 76, 60, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '中性情景',
                            data: neutralNet,
                            backgroundColor: 'rgba(52, 152, 219, 0.7)',
                            borderColor: 'rgba(52, 152, 219, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '乐观情景',
                            data: optimisticNet,
                            backgroundColor: 'rgba(46, 204, 113, 0.7)',
                            borderColor: 'rgba(46, 204, 113, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '年净利润 (CAD)'
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: '各情景年净利润对比'
                        }
                    }
                }
            });
            
            // 创建ROI对比图表
            const roiCtx = document.getElementById('roiChart').getContext('2d');
            if (window.roiChartInstance) {
                window.roiChartInstance.destroy();
            }
            window.roiChartInstance = new Chart(roiCtx, {
                type: 'bar',
                data: {
                    labels: ['保守情景', '中性情景', '乐观情景'],
                    datasets: [{
                        label: '第3年ROI (%)',
                        data: [
                            parseFloat(document.getElementById('conservative-roi-y3').textContent.replace('%', '')),
                            parseFloat(document.getElementById('neutral-roi-y3').textContent.replace('%', '')),
                            parseFloat(document.getElementById('optimistic-roi-y3').textContent.replace('%', ''))
                        ],
                        backgroundColor: [
                            'rgba(231, 76, 60, 0.7)',
                            'rgba(52, 152, 219, 0.7)',
                            'rgba(46, 204, 113, 0.7)'
                        ],
                        borderColor: [
                            'rgba(231, 76, 60, 1)',
                            'rgba(52, 152, 219, 1)',
                            'rgba(46, 204, 113, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'ROI (%)'
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: '各情景投资回报率 (ROI) 对比'
                        }
                    }
                }
            });
            
            // 创建累计净利润对比图表
            const comparisonCtx = document.getElementById('comparisonChart').getContext('2d');
            if (window.comparisonChartInstance) {
                window.comparisonChartInstance.destroy();
            }
            window.comparisonChartInstance = new Chart(comparisonCtx, {
                type: 'line',
                data: {
                    labels: ['第1年', '第2年', '第3年'],
                    datasets: [
                        {
                            label: '保守情景',
                            data: [
                                parseFloat(document.getElementById('conservative-cumulative-y1').textContent.replace('$', '').replace(/,/g, '')),
                                parseFloat(document.getElementById('conservative-cumulative-y2').textContent.replace('$', '').replace(/,/g, '')),
                                parseFloat(document.getElementById('conservative-cumulative-y3').textContent.replace('$', '').replace(/,/g, ''))
                            ],
                            backgroundColor: 'rgba(231, 76, 60, 0.2)',
                            borderColor: 'rgba(231, 76, 60, 1)',
                            borderWidth: 2,
                            tension: 0.1,
                            fill: true
                        },
                        {
                            label: '中性情景',
                            data: [
                                parseFloat(document.getElementById('neutral-cumulative-y1').textContent.replace('$', '').replace(/,/g, '')),
                                parseFloat(document.getElementById('neutral-cumulative-y2').textContent.replace('$', '').replace(/,/g, '')),
                                parseFloat(document.getElementById('neutral-cumulative-y3').textContent.replace('$', '').replace(/,/g, ''))
                            ],
                            backgroundColor: 'rgba(52, 152, 219, 0.2)',
                            borderColor: 'rgba(52, 152, 219, 1)',
                            borderWidth: 2,
                            tension: 0.1,
                            fill: true
                        },
                        {
                            label: '乐观情景',
                            data: [
                                parseFloat(document.getElementById('optimistic-cumulative-y1').textContent.replace('$', '').replace(/,/g, '')),
                                parseFloat(document.getElementById('optimistic-cumulative-y2').textContent.replace('$', '').replace(/,/g, '')),
                                parseFloat(document.getElementById('optimistic-cumulative-y3').textContent.replace('$', '').replace(/,/g, ''))
                            ],
                            backgroundColor: 'rgba(46, 204, 113, 0.2)',
                            borderColor: 'rgba(46, 204, 113, 1)',
                            borderWidth: 2,
                            tension: 0.1,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '累计净利润 (CAD)'
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: '各情景累计净利润对比'
                        }
                    }
                }
            });
        }
        
        // 重置表单
        function resetForm() {
            // 基础参数
            document.getElementById('storage-price').value = 20;
            document.getElementById('usd-cad-rate').value = 1.35;
            document.getElementById('fixed-cost').value = 60833;
            document.getElementById('investment-amount').value = 600000;
            
            // 营销业务利润率
            document.getElementById('self-operated-margin').value = 20;
            document.getElementById('agent-margin').value = 5;
            
            // 保守情景
            document.getElementById('conservative-pallets-y1').value = 1200;
            document.getElementById('conservative-pallets-y2').value = 2500;
            document.getElementById('conservative-pallets-y3').value = 4000;
            document.getElementById('conservative-fulfillment-y1').value = 50;
            document.getElementById('conservative-fulfillment-y2').value = 80;
            document.getElementById('conservative-fulfillment-y3').value = 100;
            document.getElementById('conservative-sublease-sqft').value = 20000;
            document.getElementById('conservative-sublease-price').value = 8.5;
            document.getElementById('conservative-sales-y1').value = 3000000;
            document.getElementById('conservative-sales-y2').value = 5000000;
            document.getElementById('conservative-sales-y3').value = 10000000;
            
            // 中性情景
            document.getElementById('neutral-pallets-y1').value = 1200;
            document.getElementById('neutral-pallets-y2').value = 4000;
            document.getElementById('neutral-pallets-y3').value = 6000;
            document.getElementById('neutral-fulfillment-y1').value = 50;
            document.getElementById('neutral-fulfillment-y2').value = 80;
            document.getElementById('neutral-fulfillment-y3').value = 120;
            document.getElementById('neutral-sublease-sqft').value = 20000;
            document.getElementById('neutral-sublease-price').value = 8.5;
            document.getElementById('neutral-sales-y1').value = 3000000;
            document.getElementById('neutral-sales-y2').value = 8000000;
            document.getElementById('neutral-sales-y3').value = 12000000;
            
            // 乐观情景
            document.getElementById('optimistic-pallets-y1').value = 2000;
            document.getElementById('optimistic-pallets-y2').value = 5000;
            document.getElementById('optimistic-pallets-y3').value = 7000;
            document.getElementById('optimistic-fulfillment-y1').value = 80;
            document.getElementById('optimistic-fulfillment-y2').value = 100;
            document.getElementById('optimistic-fulfillment-y3').value = 120;
            document.getElementById('optimistic-sublease-sqft').value = 20000;
            document.getElementById('optimistic-sublease-price').value = 8.5;
            document.getElementById('optimistic-sales-y1').value = 5000000;
            document.getElementById('optimistic-sales-y2').value = 10000000;
            document.getElementById('optimistic-sales-y3').value = 15000000;
            
            // 重新计算
            calculateAll();
        }
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 初始计算
            calculateAll();
        });
    </script>
</body>
</html>
